<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Aitor Ameztegui" />
    
    
    <title>Lab 2.1 - Data transformation (I): Create new variables, filter, select and organize data</title>

        <!-- HEAD_CONTENT -->
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ff0000; font-weight: bold; } /* Alert */
      code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #7d9029; } /* Attribute */
      code span.bn { color: #40a070; } /* BaseN */
      code span.bu { color: #008000; } /* BuiltIn */
      code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4070a0; } /* Char */
      code span.cn { color: #880000; } /* Constant */
      code span.co { color: #60a0b0; font-style: italic; } /* Comment */
      code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #ba2121; font-style: italic; } /* Documentation */
      code span.dt { color: #902000; } /* DataType */
      code span.dv { color: #40a070; } /* DecVal */
      code span.er { color: #ff0000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #40a070; } /* Float */
      code span.fu { color: #06287e; } /* Function */
      code span.im { color: #008000; font-weight: bold; } /* Import */
      code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #007020; font-weight: bold; } /* Keyword */
      code span.op { color: #666666; } /* Operator */
      code span.ot { color: #007020; } /* Other */
      code span.pp { color: #bc7a00; } /* Preprocessor */
      code span.sc { color: #4070a0; } /* SpecialChar */
      code span.ss { color: #bb6688; } /* SpecialString */
      code span.st { color: #4070a0; } /* String */
      code span.va { color: #19177c; } /* Variable */
      code span.vs { color: #4070a0; } /* VerbatimString */
      code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="lab.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
        
      <h1 class="title">Lab 2.1 - Data transformation (I): Create new
variables, filter, select and organize data</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Lab 2.1 - Data transformation (I): Create new
variables, filter, select and organize data</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#section-introduction"
      id="section-toc-introduction"><span
      class="toc-section-number">1</span> Introduction</a></li>
      <li><a href="#section-our-data" id="section-toc-our-data"><span
      class="toc-section-number">2</span> Our data</a>
      <ul>
      <li><a href="#section-lets-have-a-look-at-the-data"
      id="section-toc-lets-have-a-look-at-the-data"><span
      class="toc-section-number">2.1</span> Let’s have a look at the
      data</a></li>
      <li><a
      href="#section-a-more-in-depth-view-on-the-datasets-we-will-use"
      id="section-toc-a-more-in-depth-view-on-the-datasets-we-will-use"><span
      class="toc-section-number">2.2</span> A more in depth view on the
      datasets we will use</a></li>
      </ul></li>
      <li><a href="#section-data-transformation-with-dplyr"
      id="section-toc-data-transformation-with-dplyr"><span
      class="toc-section-number">3</span> <img
      src="images/03-data-transformation/dplyr.png" width="20" /> Data
      transformation with dplyr</a>
      <ul>
      <li><a href="#section-selecting-rows-with-filter"
      id="section-toc-selecting-rows-with-filter"><span
      class="toc-section-number">3.1</span> Selecting rows with
      <code>filter</code></a></li>
      <li><a href="#section-selecting-columns-with-select"
      id="section-toc-selecting-columns-with-select"><span
      class="toc-section-number">3.2</span> Selecting columns with
      <code>select</code></a></li>
      <li><a href="#section-sorting-rows-with-arrange"
      id="section-toc-sorting-rows-with-arrange"><span
      class="toc-section-number">3.3</span> Sorting rows with
      <code>arrange</code></a></li>
      <li><a href="#section-create-new-variables-with-mutate"
      id="section-toc-create-new-variables-with-mutate"><span
      class="toc-section-number">3.4</span> Create new variables with
      <code>mutate</code></a></li>
      <li><a href="#section-reducing-variables-summarise-or-summarize"
      id="section-toc-reducing-variables-summarise-or-summarize"><span
      class="toc-section-number">3.5</span> Reducing variables:
      <code>summarise</code> or <code>summarize</code></a></li>
      <li><a href="#section-combining-dplyr-verbs"
      id="section-toc-combining-dplyr-verbs"><span
      class="toc-section-number">3.6</span> Combining <code>dplyr</code>
      verbs</a></li>
      </ul></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Aitor
Ameztegui</p>
                        <p class="date"><span class="glyphicon glyphicon-calendar"></span> 111022
| Data management and visualization with R</p>
          </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div id="section-introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>As we mentioned in the introductory lessons, the <a
href="https://cran.r-project.org/web/packages/tidyverse/index.html"><code>tidyverse</code></a>
is a set of packages created by <a
href="https://github.com/hadley">Hadley Wickham</a>, chief scientist at
RStudio. The tidyverse was created to facilitate data analysis. It
consists of a set of packages for importing and reading data, for
organizing and modifying data, for analysis and modeling, and for
displaying and communicating the results. In fact, there is a package
for each of the main steps in the data analysis pipeline. The great
advantage of the tidyverse approach is that all these packages share a
common structure and grammar, making it easier to learn them and combine
them into a data analysis workflow.</p>
<p><img
src="images/03-data-transformation/tidyverse_schema_2.png" /></p>
<p>In this lab we are going to cover the basics of <strong>data
manipulation</strong> with <code>dplyr</code>. <code>dplyr</code>is a
package that focuses on data transformation, i.e. it will allow us to
start handling our data sets once they are tidy, so that we can create
new variables, filter those observations of interest, create summaries,
etc. Although the “transform” stage of the data science pipeline is
usually not the first one (we first need to import and tidy the data),
<code>dplyr</code>is the best place to start from, since it probably is
the easiest of the tidyverse packages to understand.</p>
<p>Before we start, bear in mind that:</p>
<ul>
<li><p><code>dplyr</code> (nor <code>tidyr</code> or <code>purrr</code>
or any other package in the <code>tidyverse</code>) does not do anything
that can’t be done with base R code, <code>apply</code> family
functions, <code>for</code> loops or other packages.</p></li>
<li><p>It is designed to be more efficient (in time consume and code
lines), easier to read and easier to use. It is more intuitive to use,
specially for beginners (it may require some adaptation if you are used
to base R code).</p></li>
<li><p>It is valid mostly for <code>data.frames</code>. For other
formats (matrices, arrays) <code>plyr</code> can be used
instead.</p></li>
</ul>
</div>
<div id="section-our-data" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Our data</h1>
<p>Throughout the course we are going to use several data frames, that
you will find in the RStudio Cloud project of each lab, within the
<code>data</code> folder. In this case, we are going to work with data
from the 3rd Spanish National Forest Inventory (SNFI), specifically with
5 data frames taht correspond to those plots within the four provinces
of Catalonia (Barcelona, Lleida, Girona and Tarragona). The SNFI is a
monitoring and evaluation project providing robust, reliable information
regarding forest ecosystems and their trends. It consists on a series of
permanent plots located in a grid of 1x1 km across all the Spanish
territory, which are remeasured every 10-12 years. In each plot, some
general characteristics are gathered (canopy cover, three main dominant
species, soil texture, date of measurement…), but also each tree in the
plot is located and measured (DBH and height). The information is stored
in different data frames:</p>
<ol style="list-style-type: decimal">
<li><p><code>plots</code> [11858 x 15]: contains general information for
all the plots measured in the 3rd SNF in Catalonia. Each row corresponds
to an observation (a plot), and each column is a variable.</p></li>
<li><p><code>trees</code> [111756 x 12]: all trees with dbh &gt; 7.5 cm
measured in both the second and the third forest inventory</p></li>
<li><p><code>size_distrib</code> [14778 x 15]: number of trees per
hectare in each plot, per species and size class, in the 3rd
SNFI</p></li>
<li><p><code>coordinates</code> [11858 x 6]: X and Y UTM coordinates of
each plot in the SNFI3</p></li>
<li><p><code>leaf</code> [10447 x 3]: leaf biomass and carbon content
for those SNFI3 plots where they were available .</p></li>
<li><p><code>sps_codes</code> [190 x 4]: name of the species and
associated code</p></li>
<li><p><code>prov_names</code> [52 x 2]: code and name of all the
Spanish provinces</p></li>
</ol>
<div id="section-lets-have-a-look-at-the-data" class="section level2"
number="2.1">
<h2><span class="header-section-number">2.1</span> Let’s have a look at
the data</h2>
<p>It is important that we get to know a little bit our data sets before
starting to work with them. To load the data frames you need to type
<code>load("data/data_SNFI3.Rdata")</code> or click on the
“data_SNFI3.Rdata” file within the “data” folder in the
<code>Files</code> tab of RStudio. You will see tthat the 7 data frames
have been added to your environment. To have a look at them we just need
to type their name:</p>
<div class="sourceCode" id="section-cb1"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb1-1"><a href="#section-cb1-1" tabindex="-1"></a>plots</span></code></pre></div>
<pre><code>## # A tibble: 11,858 × 17
##    Code   Province Class Subclass FccTot FccArb IniDate    IniTime            
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;     &lt;int&gt;  &lt;int&gt; &lt;date&gt;     &lt;dttm&gt;             
##  1 080001 08       A     1            80     70 2001-07-09 2001-07-09 09:44:00
##  2 080002 08       A     1            80     70 2001-08-06 2001-08-06 09:18:58
##  3 080003 08       A     1            90     80 2001-08-06 2001-08-06 12:08:09
##  4 080004 08       A     1            90     50 2001-07-09 2001-07-09 13:23:23
##  5 080005 08       A     1            70     60 2001-08-03 2001-08-03 09:11:28
##  6 080006 08       A     1            90     90 2001-08-01 2001-08-01 13:00:33
##  7 080007 08       A     1            90     90 2001-08-07 2001-08-07 10:08:15
##  8 080008 08       A     1            70     60 2001-08-03 2001-08-03 12:12:03
##  9 080009 08       A     1            80     70 2001-08-02 2001-08-02 09:00:16
## 10 080010 08       A     1            80     80 2001-06-14 2001-06-14 12:34:21
## # ℹ 11,848 more rows
## # ℹ 9 more variables: FinDate &lt;date&gt;, FinTime &lt;dttm&gt;, Rocks &lt;int&gt;,
## #   Texture &lt;int&gt;, OrgMat &lt;int&gt;, SoilPh &lt;int&gt;, PhDate &lt;date&gt;,
## #   Dom_sp_IFN2 &lt;fct&gt;, Dom_sp_IFN3 &lt;fct&gt;</code></pre>
<div class="sourceCode" id="section-cb3"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb3-1"><a href="#section-cb3-1" tabindex="-1"></a>trees</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 10
##    Code   Province Species Direction  Dist      N DC    DBH_3 DBH_2 Height_3
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 080001 08       022             7  8.3   31.8  20     20.3  18.9      9  
##  2 080002 08       476            38  9.1   31.8  35     34    32.4      9  
##  3 080003 08       021            25  7     31.8  25     24.8  17.6     11  
##  4 080004 08       021            28  8.89  31.8  15     16.8  12.6      9.5
##  5 080006 08       021            19 11.2   14.1  35     34.0  30.9     13  
##  6 080007 08       021            32 12     14.1  35     33.1  28.2     10  
##  7 080008 08       243            40  7.8   31.8  15     15    13.2      6  
##  8 080009 08       045            16  5.09  31.8  20     17.5  15.3      7  
##  9 080010 08       243            47 26.9    5.09 65     67.4  66.8     16.5
## 10 080013 08       022            44  2.7  127.   15     15.1  12.6      9.5
## # ℹ 111,746 more rows</code></pre>
<div class="sourceCode" id="section-cb5"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb5-1"><a href="#section-cb5-1" tabindex="-1"></a>size_distrib</span></code></pre></div>
<pre><code>## # A tibble: 14,778 × 15
##    Code   Species CD_10 CD_15 CD_20 CD_25 CD_30 CD_35 CD_40 CD_45 CD_50 CD_55
##    &lt;fct&gt;  &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 080001 022         0 159.   31.8 111.  60.1   19.2  5.09   0    0        0
##  2 080002 021         0   0     0     0    0     74.2 28.3   63.7  0        0
##  3 080002 022         0   0     0   173.  31.8    0    0      0    0        0
##  4 080002 476         0   0     0     0    0     31.8  0      0    0        0
##  5 080003 021         0   0     0    31.8  0      0    0      0    5.09     0
##  6 080003 022         0 127.    0     0   46.0  127.   0     14.1  0        0
##  7 080004 021         0  31.8   0     0   31.8    0    0      0    0        0
##  8 080005 071         0   0     0    14.1  5.09  31.8  0      0    0        0
##  9 080005 243         0   0    14.1   0   14.1    0    5.09   0    0        0
## 10 080005 278         0 286.   31.8   0    0     31.8  0      0    0        0
## # ℹ 14,768 more rows
## # ℹ 3 more variables: CD_60 &lt;dbl&gt;, CD_65 &lt;dbl&gt;, CD_70 &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="section-cb7"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb7-1"><a href="#section-cb7-1" tabindex="-1"></a>coordinates</span></code></pre></div>
<pre><code>## # A tibble: 11,766 × 5
##    Code   Province Class  CoorX   CoorY
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt;  &lt;int&gt;   &lt;int&gt;
##  1 080001 08       A     402000 4684000
##  2 080002 08       A     400000 4683000
##  3 080003 08       A     401000 4683000
##  4 080004 08       A     402000 4683000
##  5 080005 08       A     400000 4682000
##  6 080006 08       A     397000 4681000
##  7 080007 08       A     399000 4681000
##  8 080008 08       A     401000 4681000
##  9 080009 08       A     402000 4681000
## 10 080010 08       A     394000 4680000
## # ℹ 11,756 more rows</code></pre>
<div class="sourceCode" id="section-cb9"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb9-1"><a href="#section-cb9-1" tabindex="-1"></a>leaf</span></code></pre></div>
<pre><code>## # A tibble: 10,447 × 3
##    Code   leaf_biomass leaf_carbon
##    &lt;chr&gt;         &lt;dbl&gt;       &lt;dbl&gt;
##  1 080001        4.99        2.58 
##  2 080002        2.39        1.23 
##  3 080003        2.97        1.53 
##  4 080004        0.395       0.200
##  5 080005        1.34        0.644
##  6 080006        4.03        2.07 
##  7 080007        5.97        3.04 
##  8 080008        0.928       0.452
##  9 080009        3.85        1.94 
## 10 080010        1.54        0.758
## # ℹ 10,437 more rows</code></pre>
<div class="sourceCode" id="section-cb11"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb11-1"><a href="#section-cb11-1" tabindex="-1"></a>prov_names</span></code></pre></div>
<pre><code>## # A tibble: 52 × 2
##    Province Prov_name    
##    &lt;chr&gt;    &lt;chr&gt;        
##  1 01       Araba        
##  2 02       Albacete     
##  3 03       Alacant      
##  4 04       Almeria      
##  5 05       Avila        
##  6 06       Badajoz      
##  7 07       Illes Balears
##  8 08       Barcelona    
##  9 09       Burgos       
## 10 10       Caceres      
## # ℹ 42 more rows</code></pre>
<div class="sourceCode" id="section-cb13"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb13-1"><a href="#section-cb13-1" tabindex="-1"></a>sps_codes</span></code></pre></div>
<pre><code>## # A tibble: 190 × 4
##    Name                  Common_Name CodeIFN2 CodeIFN3
##    &lt;chr&gt;                 &lt;chr&gt;       &lt;fct&gt;    &lt;fct&gt;   
##  1 Heberdenia bahamensis Aderno      001      001     
##  2 Amelanchier ovalis    Guillomo    002      002     
##  3 Frangula alnus        Arraclán    003      003     
##  4 Rhamnus alaternus     Aladierno   004      004     
##  5 Euonymus europaeus    Bonetero    005      005     
##  6 Myrtus communis       Mirto       006      006     
##  7 Acacia spp.           Acacia      007      007     
##  8 Phillyrea latifolia   Agracejo    008      008     
##  9 Cornus sanguinea      Cornejo     009      009     
## 10 &lt;NA&gt;                  &lt;NA&gt;        010      010     
## # ℹ 180 more rows</code></pre>
<p>Maybe you have noticed that, when printing the data sets, R says they
are a <code>tibble</code>. So, what are <code>tibbles</code>? Well,
<code>tibbles</code> are the specific type of data frames that the
<code>tidyverse</code> uses. All tibbles are data frames, but not all
data frames are tibbles. In fact if we see the class of our data sets,
we see they <em>ARE</em> data frames.</p>
<div class="sourceCode" id="section-cb15"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb15-1"><a href="#section-cb15-1" tabindex="-1"></a><span class="fu">class</span>(trees)</span></code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>The only difference is that <code>tibbles</code> have all the
properties of data frames, but behave in a way that facilitates data
inspection and understanding. Data inspection must
<strong>ALWAYS</strong> be the first thing we do before starting any
kind of analysis. Understanding data is crucial to succeed, otherwise we
can have surprises, such as a variable not being correctly imported, or
a corrupt data frame. The <code>glimpse</code> function in the tidyverse
is perhaps the most informative way to know what our data looks like at
a glance. Let’s have a look at the <code>plots</code> and
<code>trees</code> data frames, which are the ones we will use in this
lab:</p>
<div class="sourceCode" id="section-cb17"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb17-1"><a href="#section-cb17-1" tabindex="-1"></a><span class="fu">glimpse</span>(plots)</span></code></pre></div>
<pre><code>## Rows: 11,858
## Columns: 17
## $ Code        &lt;fct&gt; 080001, 080002, 080003, 080004, 080005, 080006, 080007, 08…
## $ Province    &lt;fct&gt; 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, 08…
## $ Class       &lt;fct&gt; A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A…
## $ Subclass    &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ FccTot      &lt;int&gt; 80, 80, 90, 90, 70, 90, 90, 70, 80, 80, 70, 100, 90, 90, 9…
## $ FccArb      &lt;int&gt; 70, 70, 80, 50, 60, 90, 90, 60, 70, 80, 60, 95, 90, 80, 80…
## $ IniDate     &lt;date&gt; 2001-07-09, 2001-08-06, 2001-08-06, 2001-07-09, 2001-08-0…
## $ IniTime     &lt;dttm&gt; 2001-07-09 09:44:00, 2001-08-06 09:18:58, 2001-08-06 12:0…
## $ FinDate     &lt;date&gt; 2001-07-09, 2001-08-06, 2001-08-06, 2001-07-09, 2001-08-0…
## $ FinTime     &lt;dttm&gt; 2001-07-09 11:20:14, 2001-08-06 10:52:47, 2001-08-06 13:4…
## $ Rocks       &lt;int&gt; 3, 4, 3, 3, 4, 3, 3, 4, 4, 5, 5, 2, 2, 3, 2, 4, 3, 4, 5, 3…
## $ Texture     &lt;int&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, NA, NA, 3, 3, 3, 2, 2, 3, 3, NA…
## $ OrgMat      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, NA, NA, 1, 1, 2, 2, 1, 2, 1, NA…
## $ SoilPh      &lt;int&gt; 5, 5, 6, 6, 6, 5, 5, 6, 6, NA, NA, 6, 5, 6, 4, 5, 6, 6, NA…
## $ PhDate      &lt;date&gt; 2001-07-09, 2001-08-06, 2001-08-06, 2001-07-09, 2001-08-0…
## $ Dom_sp_IFN2 &lt;fct&gt; 022, 021, 022, 021, 071, 021, 021, 243, 045, 071, NA, 021,…
## $ Dom_sp_IFN3 &lt;fct&gt; 022, 021, 022, 021, 071, 021, 021, 243, 045, 071, NA, 021,…</code></pre>
<div class="sourceCode" id="section-cb19"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb19-1"><a href="#section-cb19-1" tabindex="-1"></a><span class="fu">glimpse</span>(trees)</span></code></pre></div>
<pre><code>## Rows: 111,756
## Columns: 10
## $ Code      &lt;fct&gt; 080001, 080002, 080003, 080004, 080006, 080007, 080008, 0800…
## $ Province  &lt;fct&gt; 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, 08, …
## $ Species   &lt;fct&gt; 022, 476, 021, 021, 021, 021, 243, 045, 243, 022, 021, 021, …
## $ Direction &lt;dbl&gt; 7, 38, 25, 28, 19, 32, 40, 16, 47, 44, 13, 9, 9, 25, 199, 6,…
## $ Dist      &lt;dbl&gt; 8.3, 9.1, 7.0, 8.9, 11.2, 12.0, 7.8, 5.1, 26.9, 2.7, 8.9, 1.…
## $ N         &lt;dbl&gt; 31.8, 31.8, 31.8, 31.8, 14.1, 14.1, 31.8, 31.8, 5.1, 127.3, …
## $ DC        &lt;fct&gt; 20, 35, 25, 15, 35, 35, 15, 20, 65, 15, 20, 30, 45, 20, 35, …
## $ DBH_3     &lt;dbl&gt; 20, 34, 25, 17, 34, 33, 15, 18, 67, 15, 19, 28, 46, 20, 34, …
## $ DBH_2     &lt;dbl&gt; 19, 32, 18, 13, 31, 28, 13, 15, 67, 13, 14, 25, 45, 20, 30, …
## $ Height_3  &lt;dbl&gt; 9.0, 9.0, 11.0, 9.5, 13.0, 10.0, 6.0, 7.0, 16.5, 9.5, 11.5, …</code></pre>
</div>
<div id="section-a-more-in-depth-view-on-the-datasets-we-will-use"
class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> A more in depth view
on the datasets we will use</h2>
<p>Since we are going to use mostly the data sets <code>trees</code> and
<code>plots</code> in this lab, let’s explain the variables they contain
in more depth:</p>
<p><strong>PLOTS</strong></p>
<p>This data frame contains information on each of the plots measured in
the National Forest Inventory. Note that it has 11858 rows, which is the
numer of plots that were measured in Catalonia.</p>
<ul>
<li><p><strong><code>Code</code></strong>(factor): the code of the
permanent plot.</p></li>
<li><p><strong><code>Province</code></strong> (factor): the province in
which the plot is located. For Catalonia the codes are:</p>
<ul>
<li>Barcelona: “08”</li>
<li>Girona: “17”</li>
<li>Lleida: “25”</li>
<li>Tarragona “43” You can check the rest of the codes for Spain in the
<code>prov_names</code> data frame.</li>
</ul></li>
<li><p><strong><code>Class</code></strong> (factor): type of plot,
depending if it was measured in SNFI2 or not (we will not use this
variable)</p></li>
<li><p><strong><code>Subclass</code></strong> (factor): subtype of plot,
depending if it was measured in IFN2 or not (we will not use this
variable)</p></li>
<li><p><strong><code>FccTot</code></strong> (integer): total canopy
cover in the plot</p></li>
<li><p><strong><code>FccArb</code></strong> (integer): tree canopy cover
in the plot</p></li>
<li><p><strong><code>IniDate</code></strong> (date): date at which the
plot was started to measure</p></li>
<li><p><strong><code>IniTime</code></strong> (datetime): date and time
at which the plot was started to measure</p></li>
<li><p><strong><code>FinDate</code></strong> (date): date at which the
plot was finished to measure</p></li>
<li><p><strong><code>FinTime</code></strong> (datetime): time at which
the plot was finished to measure</p></li>
<li><p><strong><code>Rocks</code></strong> (integer): proportion of
rocks in surface of the plot</p></li>
<li><p><strong><code>Texture</code></strong> (integer): soil
texture</p></li>
<li><p><strong><code>OrgMat</code></strong> (integer): amount of organic
matter in the plot</p></li>
<li><p><strong><code>SoilPh</code></strong> (integer): pH of the soil in
the plot</p></li>
<li><p><strong><code>PhDate</code></strong> (date): date at which pH was
measured</p></li>
<li><p><strong><code>Dom_sp_IFN2</code></strong> (Factor): dominant
species in the plot in the SNFI2</p></li>
<li><p><strong><code>Dom_sp_IFN3</code></strong> (Factor):dominant
species in the plot in the SNFI3</p></li>
</ul>
<p><strong>TREES</strong></p>
<p>The <code>trees</code> data frame contains information on each of the
trees measured in the National Forest Inventory. You can see that it has
many more rows than <code>plots</code>. This are the variables it
contains:</p>
<ul>
<li><strong><code>Code</code></strong> (factor): the code of the
permanent plot in which the tree is located</li>
<li><strong><code>Province</code></strong> (factor): the province in
which the plot (and therefore the tree) is located</li>
<li><strong><code>Species</code></strong> (factor): the specific
identity of the tree, as a code. You can find the meaning of each code
<a
href="https://www.miteco.gob.es/es/biodiversidad/servicios/banco-datos-naturaleza/documentador_bdcampo_ifn3_tcm30-282240.pdf">here</a>
(pages 24-28), or in the <code>sps_codes</code> data frame</li>
<li><strong><code>Direction</code></strong> (numeric): the angle from
the center of the plot to the tree, measured in centesimal degrees (so
takes values from 0 to 400)</li>
<li><strong><code>Dist</code></strong> (numeric): the distance from the
center of the plot to the tree, in meters</li>
<li><strong><code>N</code></strong> (numeric): number of trees per
hectare that each tree represents (since the plots are smaller than 1 ha
and not all of them have the same size, it is the conversion factor that
allows us to do calculations per hectare and compare results across
plots)</li>
<li><strong><code>DC</code></strong> (factor): diameter class, in
centimeters and grouped in 5 cm classes</li>
<li><strong><code>DBH_3</code></strong> (double): tree diameter at
breast height, in centimeters, as measured in SNFI3</li>
<li><strong><code>DBH_2</code></strong> (double): tree diameter at
breast height, in centimeters, as measured in SNFI2</li>
<li><strong><code>Height_3</code></strong> (double): tree height, in
meters, as measured in SNFI3</li>
</ul>
</div>
</div>
<div id="section-data-transformation-with-dplyr" class="section level1"
number="3">
<h1><span class="header-section-number">3</span> <img
src="images/03-data-transformation/dplyr.png" width="20" /> Data
transformation with dplyr</h1>
<p><img src="images/03-data-transformation/dplyr.png" width="200" /></p>
<p><code>dplyr</code> is a essentially a <strong>grammar for data
manipulation</strong>, providing a consistent set of <em>verbs</em>
(i.e. functions) that help you solve the most common data manipulation
challenges.</p>
<p>The 5 main verbs of dplyr are:</p>
<ul>
<li><p><code>filter</code>: keep/select the rows that match a given
condition</p></li>
<li><p><code>select</code>: keep columns by name</p></li>
<li><p><code>arrange</code>: sort rows acording to a given
variable</p></li>
<li><p><code>mutate</code>: transform existent variables or create new
ones</p></li>
<li><p><code>summarise</code>: do some summary statistics and reduce
data</p></li>
</ul>
<p>Most of the tidyverse verbs/functions share certain elements in
common and <code>dplyr</code> is certainly not an exception. The basic
syntax works like this:</p>
<div class="sourceCode" id="section-cb21"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb21-1"><a href="#section-cb21-1" tabindex="-1"></a><span class="fu">verb</span>(data, ...)</span></code></pre></div>
<ul>
<li>The first argument is ALWAYS the data frame</li>
<li>The rest of arguments specify what to do with the data, and depend
on the specific verb.</li>
<li>Output is always another data frame (<code>tbl_df</code> or
<code>data.frame</code>).</li>
<li>Unless we are assigning (<code>&lt;-</code>) the result into an
object, functions never modify the original data.</li>
</ul>
<p>In this course we are going to cover the main verbs of
<code>dplyr</code>, but this is only a small subset of what it can do.
Just a quick check into its <a
href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf"><em>cheatsheet</em></a>
or the <a href="https://dplyr.tidyverse.org/reference/index.html">dplyr
website</a> reveals a wide range of possibilities:</p>
<p><img
src="images/03-data-transformation/data-transformation-cheatsheet-thumbs.png" /></p>
<div id="section-selecting-rows-with-filter" class="section level2"
number="3.1">
<h2><span class="header-section-number">3.1</span> Selecting rows with
<code>filter</code></h2>
<p>Use <code>filter()</code> to choose rows/cases/observations where a
given condition(s) is <code>TRUE</code>. The first argument in
<code>filter</code>is the dataframe we want it to apply to, and the rest
are the criteria for the filtering. If there are several criteria, they
can be separated by commas:</p>
<p><img src="images/03-data-transformation/filter.png" /> &gt; The key
aspect of <code>filter</code> lies on building the <em>condition</em>
that must be met. Doing so involves the use of
<code>logical operators</code>:</p>
<p><img src="images/03-data-transformation/logical_operators2.png"
width="500" /></p>
<p>Let’s see a few basic examples applied to the <code>trees</code>
table:</p>
<ol style="list-style-type: decimal">
<li>Get trees taller than 6 meters:</li>
</ol>
<div class="sourceCode" id="section-cb22"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb22-1"><a href="#section-cb22-1" tabindex="-1"></a><span class="fu">filter</span>(trees, Height_3 <span class="sc">&gt;</span> <span class="dv">6</span>) </span></code></pre></div>
<pre><code>## # A tibble: 100,247 × 10
##    Code   Province Species Direction  Dist      N DC    DBH_3 DBH_2 Height_3
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 080001 08       022             7  8.3   31.8  20     20.3  18.9      9  
##  2 080002 08       476            38  9.1   31.8  35     34    32.4      9  
##  3 080003 08       021            25  7     31.8  25     24.8  17.6     11  
##  4 080004 08       021            28  8.89  31.8  15     16.8  12.6      9.5
##  5 080006 08       021            19 11.2   14.1  35     34.0  30.9     13  
##  6 080007 08       021            32 12     14.1  35     33.1  28.2     10  
##  7 080009 08       045            16  5.09  31.8  20     17.5  15.3      7  
##  8 080010 08       243            47 26.9    5.09 65     67.4  66.8     16.5
##  9 080013 08       022            44  2.7  127.   15     15.1  12.6      9.5
## 10 080014 08       021            13  8.89  31.8  20     19.2  14.2     11.5
## # ℹ 100,237 more rows</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Get trees in Tarragona (province 43):</li>
</ol>
<div class="sourceCode" id="section-cb24"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb24-1"><a href="#section-cb24-1" tabindex="-1"></a><span class="fu">filter</span>(trees, Province <span class="sc">==</span> <span class="st">&#39;43&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 9,693 × 10
##    Code   Province Species Direction  Dist     N DC    DBH_3 DBH_2 Height_3
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 430003 43       024             6  9.69  31.8 30     28.1 20.4      10.5
##  2 430006 43       023            24  9.69  31.8 30     28.2 23.2      10.5
##  3 430007 43       024             0  8.8   31.8 30     30.4 27.8      10.5
##  4 430009 43       024            15  9.89  31.8 30     30.4 30.4      11  
##  5 430010 43       024            33 12.1   14.1 45     47.2 42.0      13.5
##  6 430011 43       044             1  2.09 127.  10     11.0  9.65      6  
##  7 430012 43       024            31 13     14.1 35     33.0 26.5      12.5
##  8 430013 43       024            80  1.89 127.  40     38.4 35.7      11  
##  9 430014 43       025             4  4.3  127.  15     14.0 11.2       5  
## 10 430015 43       024            22 11.2   14.1 30     31.2 27.4       9  
## # ℹ 9,683 more rows</code></pre>
<blockquote>
<p>Note that you need the double <code>==</code> to create the
condition. the difference between <code>==</code> and <code>=</code> was
explained in the introductory lessons, but you can find a good thread
about this issue in this <a
href="https://www.quora.com/What-is-the-difference-between-and-in-R-2">forum</a>
(I told you that you can find all the answers in R forums ;-)</p>
</blockquote>
<ol start="3" style="list-style-type: decimal">
<li>Get trees in diametric classes 45 and 70:</li>
</ol>
<div class="sourceCode" id="section-cb26"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb26-1"><a href="#section-cb26-1" tabindex="-1"></a><span class="fu">filter</span>(trees, DC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">70</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2,552 × 10
##    Code   Province Species Direction  Dist     N DC    DBH_3 DBH_2 Height_3
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 080016 08       071             9 26.9   5.09 45     46.0  45       19  
##  2 080113 08       021            19 11.1  14.1  70     72.6  70.7     20.9
##  3 080686 08       042            43  7.09 31.8  45     44.3  42.5     12.5
##  4 080721 08       042            16 15.8   5.09 45     46.2  39.8     17.5
##  5 080743 08       042             3  9.69 31.8  45     46.1  40.7     25.5
##  6 081271 08       024            93 10.8  14.1  45     44.0  39.0     17.3
##  7 081278 08       024            87 10.1  14.1  45     44.6  38.9     15.1
##  8 081354 08       026            16  8.6  31.8  45     43.4  30.8     16.9
##  9 081402 08       054            51  5.19 31.8  70    102.   95.5     17.7
## 10 081943 08       024             1 10.3  14.1  45     43.2  33.8     11.7
## # ℹ 2,542 more rows</code></pre>
<p>You see here how the <code>%in%</code> operator works. It will get
any value that is included in a vector of values</p>
<div class="exercise">
<p><strong>EXERCISE 1:</strong> </br></p>
<p>1.1 Try now doing the following:</p>
<div>
<p>filter(trees, Height_3 &gt;= 6)</p>
</div>
<p>Why is the result different from the example 1 we have done
above?<br />
Which of the two outputs has more rows on it?</p>
<p>Let’s find those <strong><em>plots</em></strong> in SNFI3 that:</p>
<p>1.2 Are located <strong>either</strong> in Barcelona (08) or Girona
(17)<br />
Hint: we need to use now the <code>plots</code> data frame</p>
<div class="tutorial-exercise" data-label="ex1-2" data-completion="1"
data-diagnostics="1" data-startover="1" data-lines="0"
data-pipe="|&gt;">
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
<div class="tutorial-exercise-support" data-label="ex1-2-hint-1"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0" data-pipe="|&gt;">
<pre class="text"><code>filter()</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="ex1-2-hint-2"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0" data-pipe="|&gt;">
<pre class="text"><code>filter(plot,)</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="ex1-2-solution"
data-completion="1" data-diagnostics="1" data-startover="1"
data-lines="0" data-pipe="|&gt;">
<pre class="text"><code>filter(plot,Province %in% c(&quot;08&quot;, &quot;17&quot;))</code></pre>
</div>
<p>1.3 Were measured <strong>in</strong> January of 2001</p>
<p>1.4 Select those plots which took <strong>more</strong> than 2 hours
to measure (7200s)</br> Hint: we can include an arithmetic operation
between two variables within a <code>filter</code> function</p>
</div>
</div>
<div id="section-selecting-columns-with-select" class="section level2"
number="3.2">
<h2><span class="header-section-number">3.2</span> Selecting columns
with <code>select</code></h2>
<p><code>select</code> is the function in <code>dplyr</code> to choose
variables (i.e., columns) from a data frame. Again, the first argument
of <code>select</code> is the data frame to which we want to apply the
function, and the subsequent arguments are the variables to select. It
will only keep those that are mentioned.</p>
<p><img src="images/03-data-transformation/select.png"
width="250" /></p>
<p>Let’s see some examples:</p>
<ol style="list-style-type: decimal">
<li>Selecting a single column/variable:</li>
</ol>
<div class="sourceCode" id="section-cb31"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb31-1"><a href="#section-cb31-1" tabindex="-1"></a><span class="fu">select</span>(trees, DBH_3)</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 1
##    DBH_3
##    &lt;dbl&gt;
##  1  20.3
##  2  34  
##  3  24.8
##  4  16.8
##  5  34.0
##  6  33.1
##  7  15  
##  8  17.5
##  9  67.4
## 10  15.1
## # ℹ 111,746 more rows</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Selecting all columns but the targeted one. The <code>-</code>
operator excludes the targeted variable so that we only keep the
remaining variables:</li>
</ol>
<div class="sourceCode" id="section-cb33"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb33-1"><a href="#section-cb33-1" tabindex="-1"></a><span class="fu">select</span>(trees, <span class="sc">-</span>Code)</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 9
##    Province Species Direction  Dist      N DC    DBH_3 DBH_2 Height_3
##    &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 08       022             7  8.3   31.8  20     20.3  18.9      9  
##  2 08       476            38  9.1   31.8  35     34    32.4      9  
##  3 08       021            25  7     31.8  25     24.8  17.6     11  
##  4 08       021            28  8.89  31.8  15     16.8  12.6      9.5
##  5 08       021            19 11.2   14.1  35     34.0  30.9     13  
##  6 08       021            32 12     14.1  35     33.1  28.2     10  
##  7 08       243            40  7.8   31.8  15     15    13.2      6  
##  8 08       045            16  5.09  31.8  20     17.5  15.3      7  
##  9 08       243            47 26.9    5.09 65     67.4  66.8     16.5
## 10 08       022            44  2.7  127.   15     15.1  12.6      9.5
## # ℹ 111,746 more rows</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Select several columns:</li>
</ol>
<div class="sourceCode" id="section-cb35"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb35-1"><a href="#section-cb35-1" tabindex="-1"></a><span class="fu">select</span>(trees, DBH_2, DBH_3)</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 2
##    DBH_2 DBH_3
##    &lt;dbl&gt; &lt;dbl&gt;
##  1  18.9  20.3
##  2  32.4  34  
##  3  17.6  24.8
##  4  12.6  16.8
##  5  30.9  34.0
##  6  28.2  33.1
##  7  13.2  15  
##  8  15.3  17.5
##  9  66.8  67.4
## 10  12.6  15.1
## # ℹ 111,746 more rows</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Selecting a range of columns. The <code>:</code> operator allows
referencing a set of contiguous columns so that all variables contained
in that range will be included:</li>
</ol>
<div class="sourceCode" id="section-cb37"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb37-1"><a href="#section-cb37-1" tabindex="-1"></a><span class="fu">select</span>(trees, Code<span class="sc">:</span>Dist)</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 5
##    Code   Province Species Direction  Dist
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;
##  1 080001 08       022             7  8.3 
##  2 080002 08       476            38  9.1 
##  3 080003 08       021            25  7   
##  4 080004 08       021            28  8.89
##  5 080006 08       021            19 11.2 
##  6 080007 08       021            32 12   
##  7 080008 08       243            40  7.8 
##  8 080009 08       045            16  5.09
##  9 080010 08       243            47 26.9 
## 10 080013 08       022            44  2.7 
## # ℹ 111,746 more rows</code></pre>
<blockquote>
<p>We can combine <code>-</code> and <code>:</code> to exclude a range
of columns, though we must use a <code>vector</code> to specify the
range using parenthesis:</p>
</blockquote>
<div class="sourceCode" id="section-cb39"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb39-1"><a href="#section-cb39-1" tabindex="-1"></a><span class="co">#(trees, -Codi:Dist) this won&#39;t work</span></span>
<span id="section-cb39-2"><a href="#section-cb39-2" tabindex="-1"></a><span class="fu">select</span>(trees,<span class="sc">-</span>(Code<span class="sc">:</span>Dist))  <span class="co"># This will work</span></span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 5
##         N DC    DBH_3 DBH_2 Height_3
##     &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1  31.8  20     20.3  18.9      9  
##  2  31.8  35     34    32.4      9  
##  3  31.8  25     24.8  17.6     11  
##  4  31.8  15     16.8  12.6      9.5
##  5  14.1  35     34.0  30.9     13  
##  6  14.1  35     33.1  28.2     10  
##  7  31.8  15     15    13.2      6  
##  8  31.8  20     17.5  15.3      7  
##  9   5.09 65     67.4  66.8     16.5
## 10 127.   15     15.1  12.6      9.5
## # ℹ 111,746 more rows</code></pre>
<blockquote>
<p>We can also leverage some special functions specifically design to
work with strings to enhance column extraction:</p>
<ul>
<li><p><code>starts_with(x)</code>: names that start with
<em>x</em>.</p></li>
<li><p><code>ends_with(x)</code>: names that end with
<em>x</em>.</p></li>
<li><p><code>contains(x)</code>: selects all variables whose name
contains <em>x</em>.</p></li>
<li><p><code>matches(x)</code>: selects all variables whose name
contains the regular expression <em>x</em>.</p></li>
<li><p><code>num_range("x", 1:5, width = 2)</code>: selects all
variables (numerically) from x01 to x05</p></li>
<li><p><code>one_of ("x", "y", "z")</code>: selects variables provided
in a character vector.</p></li>
</ul>
<p>You can check the list of special functions with
<code>help(select)</code>, or checking the <a
href="https://tidyselect.r-lib.org/reference/language.html">tidyselect
website</a>.</p>
</blockquote>
<p>Let’s try one of these special functions:</p>
<ol start="5" style="list-style-type: decimal">
<li>Select any column that starts with the string <code>DBH</code>:</li>
</ol>
<div class="sourceCode" id="section-cb41"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb41-1"><a href="#section-cb41-1" tabindex="-1"></a><span class="fu">select</span>(trees, <span class="fu">starts_with</span>(<span class="st">&#39;DBH&#39;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 2
##    DBH_3 DBH_2
##    &lt;dbl&gt; &lt;dbl&gt;
##  1  20.3  18.9
##  2  34    32.4
##  3  24.8  17.6
##  4  16.8  12.6
##  5  34.0  30.9
##  6  33.1  28.2
##  7  15    13.2
##  8  17.5  15.3
##  9  67.4  66.8
## 10  15.1  12.6
## # ℹ 111,746 more rows</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Select any column that contains the letter <code>D</code>:</li>
</ol>
<div class="sourceCode" id="section-cb43"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb43-1"><a href="#section-cb43-1" tabindex="-1"></a><span class="fu">select</span>(trees,<span class="fu">contains</span>(<span class="st">&#39;D&#39;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 6
##    Code   Direction  Dist DC    DBH_3 DBH_2
##    &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 080001         7  8.3  20     20.3  18.9
##  2 080002        38  9.1  35     34    32.4
##  3 080003        25  7    25     24.8  17.6
##  4 080004        28  8.89 15     16.8  12.6
##  5 080006        19 11.2  35     34.0  30.9
##  6 080007        32 12    35     33.1  28.2
##  7 080008        40  7.8  15     15    13.2
##  8 080009        16  5.09 20     17.5  15.3
##  9 080010        47 26.9  65     67.4  66.8
## 10 080013        44  2.7  15     15.1  12.6
## # ℹ 111,746 more rows</code></pre>
<blockquote>
<p>You may have noticed that select keeps only the variables you
mention, but even if we only select one variable, the output is still a
data frame. To extract a given columns as a vector we can use the
function pull().</p>
</blockquote>
<div class="exercise">
<p><strong>EXERCISE 2</strong> </br></p>
<p>Think of three or four different ways to select the variables that
define the start and finish date of plot measuring.</p>
</div>
</div>
<div id="section-sorting-rows-with-arrange" class="section level2"
number="3.3">
<h2><span class="header-section-number">3.3</span> Sorting rows with
<code>arrange</code></h2>
<p><code>arrange</code> allows sorting a data frame according to the
values of a <em>guiding</em> variable. <code>arrange</code> can sort the
database based on one or more variables. The first argument will be, as
always, the data frame that we want to re-sort, and then we specify the
variables that determine the sorting order. If we specify more than 1
variable, the successive variables will serve to break the ties of the
previous ones. Sorting can be done in either <em>ascending</em> or
<em>descending</em> order, both with numerical (increase or decrease) or
alphanumerical (alphabetical order) variables.</p>
<blockquote>
<p>As we will see in further sections, sorting data may significantly
help in the process of data visualization, and can also be an easy way
to inspect the range of data of a particular variable.</p>
</blockquote>
<p><img src="images/03-data-transformation/arrange.png" /></p>
<p>Let’s see a few examples:</p>
<ol style="list-style-type: decimal">
<li>Sort trees ascending by height in the third forest inventory:</li>
</ol>
<div class="sourceCode" id="section-cb45"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb45-1"><a href="#section-cb45-1" tabindex="-1"></a><span class="fu">arrange</span>(trees, Height_3)</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 10
##    Code   Province Species Direction  Dist     N DC    DBH_3 DBH_2 Height_3
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 171919 17       045            72  4.5  127.  10    10.2  10.4      1.5 
##  2 171806 17       046           138  4.5  127.  10    11.9   9.95     1.5 
##  3 171049 17       045           331  3.29 127.  10     7.65  7.65     1.5 
##  4 080073 08       071           269  3.9  127.  10    10.4   9.2      1.6 
##  5 082415 08       045             9  4.69 127.  10     9.7   9.7      1.79
##  6 082451 08       044            33  1    127.  10     7.9   8.1      2   
##  7 171959 17       068            17  3.29 127.  10     9.95  8.4      2   
##  8 250494 25       042            29  3.09 127.  10     8.45  8.45     2   
##  9 251649 25       022             5  5.5   31.8 15    14    14        2   
## 10 080664 08       042            49  4.19 127.  10     8.45  8.3      2   
## # ℹ 111,746 more rows</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Sort them descending:</li>
</ol>
<div class="sourceCode" id="section-cb47"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb47-1"><a href="#section-cb47-1" tabindex="-1"></a><span class="fu">arrange</span>(trees, <span class="fu">desc</span>(Height_3))</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 10
##    Code   Province Species Direction  Dist     N DC    DBH_3 DBH_2 Height_3
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 171851 17       034           335 11.4  14.1  55     56.4  46.8     38  
##  2 170121 17       258           380 14.2  14.1  50     48.7  40.6     37.5
##  3 171707 17       258           282 16.8   5.09 55     54.2  43.6     37.2
##  4 170121 17       258           372 21.3   5.09 55     56.9  49.5     36  
##  5 170709 17       071           316 22.9   5.09 55     56.6  45.2     36  
##  6 171851 17       034           373  7.19 31.8  55     54.6  48.6     36  
##  7 250047 25       031           330 11.9  14.1  70     74.2  70.3     35.8
##  8 250025 25       031           350 34.8   5.09 70     75.1  71.3     35.7
##  9 250047 25       031           181  8.6  31.8  65     63.3  60.8     35.5
## 10 170709 17       071           298 26.2   5.09 60     62.4  55.0     35.5
## # ℹ 111,746 more rows</code></pre>
<div class="exercise">
<p><strong>EXERCISE 3</strong> </br></p>
<p>3.1 Sort plots by date and hour of measurement</p>
<p>3.2 Which plots were started to be measured later in the day?</p>
<p>3.3 Which plots took longer to be measured?</br> Hint: as we did with
<code>filter</code>, we can also sort a data frame based on the result
of an arithmetic operation between two variables.</p>
</div>
</div>
<div id="section-create-new-variables-with-mutate"
class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Create new variables
with <code>mutate</code></h2>
<p><code>mutate()</code> allows to create/calculate new
columns/variables in our dataset. It is perhaps one of the most used
functions, given its ability to either create or update variables in a
given <code>tibble</code> or <code>data.frame</code>. We just need to
specify the dataframe where we want to create the variable, and its
value:</p>
<p><img src="images/03-data-transformation/mutate.png" /></p>
<p>The basic syntax of <code>mutate</code> allows to especify the name
of variable (<code>variable_name = data_operation</code>) and then the
operation by which we assign information to it.</p>
<p>Let’s see some examples:</p>
<ol style="list-style-type: decimal">
<li>Calculate a new variable with tree height in cm:</li>
</ol>
<div class="sourceCode" id="section-cb49"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb49-1"><a href="#section-cb49-1" tabindex="-1"></a><span class="fu">mutate</span>(trees, <span class="at">Height_cm =</span> Height_3 <span class="sc">*</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 11
##    Code   Province Species Direction  Dist      N DC    DBH_3 DBH_2 Height_3
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 080001 08       022             7  8.3   31.8  20     20.3  18.9      9  
##  2 080002 08       476            38  9.1   31.8  35     34    32.4      9  
##  3 080003 08       021            25  7     31.8  25     24.8  17.6     11  
##  4 080004 08       021            28  8.89  31.8  15     16.8  12.6      9.5
##  5 080006 08       021            19 11.2   14.1  35     34.0  30.9     13  
##  6 080007 08       021            32 12     14.1  35     33.1  28.2     10  
##  7 080008 08       243            40  7.8   31.8  15     15    13.2      6  
##  8 080009 08       045            16  5.09  31.8  20     17.5  15.3      7  
##  9 080010 08       243            47 26.9    5.09 65     67.4  66.8     16.5
## 10 080013 08       022            44  2.7  127.   15     15.1  12.6      9.5
## # ℹ 111,746 more rows
## # ℹ 1 more variable: Height_cm &lt;dbl&gt;</code></pre>
<blockquote>
<p>Note that several operations can be conducted at once just by
separating as many operations as we want, using <code>,</code>:</p>
</blockquote>
<div class="sourceCode" id="section-cb51"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb51-1"><a href="#section-cb51-1" tabindex="-1"></a><span class="fu">mutate</span>(trees,</span>
<span id="section-cb51-2"><a href="#section-cb51-2" tabindex="-1"></a>       <span class="at">Allometry =</span> DBH_3 <span class="sc">/</span> Height_3,</span>
<span id="section-cb51-3"><a href="#section-cb51-3" tabindex="-1"></a>       <span class="at">Allometry2 =</span> Allometry <span class="sc">*</span> DBH_2</span>
<span id="section-cb51-4"><a href="#section-cb51-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 111,756 × 12
##    Code   Province Species Direction  Dist      N DC    DBH_3 DBH_2 Height_3
##    &lt;fct&gt;  &lt;fct&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 080001 08       022             7  8.3   31.8  20     20.3  18.9      9  
##  2 080002 08       476            38  9.1   31.8  35     34    32.4      9  
##  3 080003 08       021            25  7     31.8  25     24.8  17.6     11  
##  4 080004 08       021            28  8.89  31.8  15     16.8  12.6      9.5
##  5 080006 08       021            19 11.2   14.1  35     34.0  30.9     13  
##  6 080007 08       021            32 12     14.1  35     33.1  28.2     10  
##  7 080008 08       243            40  7.8   31.8  15     15    13.2      6  
##  8 080009 08       045            16  5.09  31.8  20     17.5  15.3      7  
##  9 080010 08       243            47 26.9    5.09 65     67.4  66.8     16.5
## 10 080013 08       022            44  2.7  127.   15     15.1  12.6      9.5
## # ℹ 111,746 more rows
## # ℹ 2 more variables: Allometry &lt;dbl&gt;, Allometry2 &lt;dbl&gt;</code></pre>
<blockquote>
<p>We can even create a variable based on another one that we have just
created, and that did not exist in the original data frame
(e.g. Allometry2 is based on Allometry)</p>
</blockquote>
<div class="exercise">
<p><strong>EXERCISE 4</strong></br></p>
<p>4.1 Get diameter growth (in cm) of each tree between SNFI2 (DBH_2)
and SNFI3 (DBH_3)</p>
<p>4.2 Create two new variables with basal area of each tree (in <span
class="math inline">\(m^2\)</span> per hectare), both for SNFI2 and
SNFI3. The function for calculating BA is:</p>
<div>
<p><span class="math display">\[
BA = \frac{\pi}{4} · DBH^{2} · N
\]</span></p>
</div>
<p>where N is the number of trees per hectare.</p>
<p>4.3 Which is the species of the tree with fastest-growing tree in
basal area in Catalonia?<br />
Hint: to solve this exercise you need to combine <code>mutate</code>with
one of the other verbs we’ve just covered.</p>
</div>
<blockquote>
<p>If we use <code>mutate</code> and the name of the variable already
exists, then that variable is replaced and updated with the new values.
Otherwise, we will create a new variable. Nonetheless, it wouldn’t
actually be replaced unless we use <code>&lt;-</code> to store the
result of our function into an object. If we do want to change the name
of a variable without changing its values, we can use the verb
<code>rename</code>, also available in <code>dplyr</code>, and which has
the same syntax as <code>mutate</code>.</p>
</blockquote>
</div>
<div id="section-reducing-variables-summarise-or-summarize"
class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Reducing variables:
<code>summarise</code> or <code>summarize</code></h2>
<p>Data manipulation means different things to different researchers.
Sometimes we want to select certain observations (rows) or variables
(columns), other times we want to group the data according to one or
more variables, or we want to calculate statistical values from
according to a grouping or category scheme.</p>
<p><code>summarise</code> allows us to make calculations with the
variables in the data frame, but using <em>summary functions</em>,
i.e. functions that transform the variability in a given variable into a
single value. Functions such as <code>sum</code>, <code>mean</code>,
<code>max</code>,<code>IQR</code>, etc. are examples of summary
functions.</p>
<p><img src="images/03-data-transformation/summarise.png" /></p>
<p>As in mutate, we first specify the data frame, then the name of the
new variable and the value it will get
(<code>variable_name = data_operation)</code>. We can leverage common
statistical/summary functions to summarize numerical variables:</p>
<ul>
<li><p>Range indicators: <code>min(x)</code>, <code>max(x)</code>,
<code>quantile(x, p)</code></p></li>
<li><p>Central measures: <code>mean(x)</code>,
<code>median(x)</code>,</p></li>
<li><p>Dispersion measures: <code>sd(x)</code>, <code>var(x)</code>,
<code>IQR(x)</code></p></li>
<li><p>Counts: <code>n()</code>, <code>n_distinct(x)</code></p></li>
<li><p>Conditional statistics: <code>sum(x &gt; 10)</code>,
<code>mean(x &gt; 10)</code></p></li>
</ul>
<p>Let’s see <code>summarise</code> in action:</p>
<ol style="list-style-type: decimal">
<li>Let’s get the mean diameter of all the trees in the dataset</li>
</ol>
<div class="sourceCode" id="section-cb53"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb53-1"><a href="#section-cb53-1" tabindex="-1"></a><span class="fu">summarise</span>(trees, <span class="at">DBH_mean =</span> <span class="fu">mean</span>(DBH_3))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   DBH_mean
##      &lt;dbl&gt;
## 1     23.4</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Actually, the <code>mean</code> means nothing without the standard
deviation. Fortunately, we can concatenate summaries just using
<code>,</code> to implement additional summaries:</li>
</ol>
<div class="sourceCode" id="section-cb55"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb55-1"><a href="#section-cb55-1" tabindex="-1"></a><span class="fu">summarise</span>(trees, </span>
<span id="section-cb55-2"><a href="#section-cb55-2" tabindex="-1"></a>          <span class="at">DBH_mean =</span> <span class="fu">mean</span>(DBH_3), </span>
<span id="section-cb55-3"><a href="#section-cb55-3" tabindex="-1"></a>          <span class="at">DBH_sd =</span> <span class="fu">sd</span>(DBH_3))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   DBH_mean DBH_sd
##      &lt;dbl&gt;  &lt;dbl&gt;
## 1     23.4   10.3</code></pre>
<div id="section-grouped-summaries-group_by" class="section level3"
number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Grouped summaries:
<code>group_by</code></h3>
<p>The summary of a variable is important to have an idea about the
data. However, summarizing a variable by the whole data set is often not
so useful. Summarizing by group gives better information on the
distribution of the data. In fact, one of the most common ways in which
we create summaries is by grouping on the basis of certain information.
That means, we split observations between a number of groups and the
calculate the summary statistics for each of them. This is why
<code>summarise</code> is most often used in conjunction with
<code>group_by</code>, which classifies the data frame into groups based
on a categorical variable.</p>
<p><img src="images/03-data-transformation/group_summarise.png" /></p>
<p>In the case of our data frame <code>trees</code>, there are several
groups that could be of interest:</p>
<div class="sourceCode" id="section-cb57"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb57-1"><a href="#section-cb57-1" tabindex="-1"></a><span class="co"># Per province</span></span>
<span id="section-cb57-2"><a href="#section-cb57-2" tabindex="-1"></a>by_province <span class="ot">&lt;-</span> <span class="fu">group_by</span> (trees, Province)</span>
<span id="section-cb57-3"><a href="#section-cb57-3" tabindex="-1"></a></span>
<span id="section-cb57-4"><a href="#section-cb57-4" tabindex="-1"></a><span class="co"># Per plot </span></span>
<span id="section-cb57-5"><a href="#section-cb57-5" tabindex="-1"></a>by_plot <span class="ot">&lt;-</span> <span class="fu">group_by</span> (trees, Code)</span>
<span id="section-cb57-6"><a href="#section-cb57-6" tabindex="-1"></a></span>
<span id="section-cb57-7"><a href="#section-cb57-7" tabindex="-1"></a><span class="co"># Per species</span></span>
<span id="section-cb57-8"><a href="#section-cb57-8" tabindex="-1"></a>by_species <span class="ot">&lt;-</span> <span class="fu">group_by</span> (trees, Species)</span>
<span id="section-cb57-9"><a href="#section-cb57-9" tabindex="-1"></a></span>
<span id="section-cb57-10"><a href="#section-cb57-10" tabindex="-1"></a><span class="co"># per diameter class</span></span>
<span id="section-cb57-11"><a href="#section-cb57-11" tabindex="-1"></a>by_DC <span class="ot">&lt;-</span> <span class="fu">group_by</span> (trees, DC)</span>
<span id="section-cb57-12"><a href="#section-cb57-12" tabindex="-1"></a></span>
<span id="section-cb57-13"><a href="#section-cb57-13" tabindex="-1"></a><span class="co"># Per plot and species</span></span>
<span id="section-cb57-14"><a href="#section-cb57-14" tabindex="-1"></a>by_plot_species <span class="ot">&lt;-</span> <span class="fu">group_by</span> (trees, Code, Species)</span></code></pre></div>
<p>You can see, by typing for example <code>glimpse(by_plot)</code> that
the resulting data frame does not differ at all from the original,
apparently, but has a hidden index that identifies to which class
belongs each observation. Moreover, it has now the class
<code>grouped_df</code>, that indicates this is a grouped table.</p>
<ol start="3" style="list-style-type: decimal">
<li>Now we can apply <code>summarise</code> to get an aggregation value
per group category. In this case we will calculate the mean and maximum
height per tree species:</li>
</ol>
<div class="sourceCode" id="section-cb58"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb58-1"><a href="#section-cb58-1" tabindex="-1"></a><span class="fu">summarise</span>(</span>
<span id="section-cb58-2"><a href="#section-cb58-2" tabindex="-1"></a>  by_species,</span>
<span id="section-cb58-3"><a href="#section-cb58-3" tabindex="-1"></a>  <span class="at">mean_height =</span> <span class="fu">mean</span>(Height_3, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="section-cb58-4"><a href="#section-cb58-4" tabindex="-1"></a>  <span class="at">max_height =</span> <span class="fu">max</span>(Height_3, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="section-cb58-5"><a href="#section-cb58-5" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 91 × 3
##    Species mean_height max_height
##    &lt;fct&gt;         &lt;dbl&gt;      &lt;dbl&gt;
##  1 004            5.4         5.8
##  2 008            6.27       10  
##  3 012            6.78       10  
##  4 013            9.61       17.2
##  5 014            7.45        8  
##  6 015            7           9  
##  7 016            7.72       12  
##  8 017           19.8        28  
##  9 019            7.13       17.3
## 10 021           12.6        28.5
## # ℹ 81 more rows</code></pre>
<div class="exercise">
<p><strong>EXERCISE 5</strong></br></p>
<p>Let’s calculate some statistics to characterize the diameter values
of the trees <em>for each plot</em>?</p>
<p>5.1 Let’s try to calculate the mean, minimum and maximum values, the
90th percentile and the interquartile range of tree diameter (DBH_3)
<em>for each plot</em> (remember, you can and <em>SHOULD</em> look for
help to know how to calculate these values).</p>
<p><strong>NOTE:</strong> Whenever there are missing values in your
dataset (<code>NA</code>), you will find the result of the mean, minimu,
or maximum functions is always <code>NA</code>. To avoid this, you can
use the argument <code>na.rm = TRUE</code> to exclude missing values.
More info here: <a href="https://www.statology.org/na-rm/"
class="uri">https://www.statology.org/na-rm/</a></p>
<p>5.2 Compute (i) the number of trees measured per plot and (ii) the
number of different species per plot, using respectively the functions
<code>n()</code> and <code>n_distinct(x)</code>.</p>
</div>
</div>
</div>
<div id="section-combining-dplyr-verbs" class="section level2"
number="3.6">
<h2><span class="header-section-number">3.6</span> Combining
<code>dplyr</code> verbs</h2>
<p>As we have mentioned several times, the good thing about all these
verbs is that they can be connected so we can easily construct a data
science workflow. Imagine we want to know which are the species that
grow the most in average for each province. We could do the
following:</p>
<div class="sourceCode" id="section-cb60"><pre
class="sourceCode r"><code class="sourceCode r"><span id="section-cb60-1"><a href="#section-cb60-1" tabindex="-1"></a><span class="co"># 1 Calculate growth of each tree</span></span>
<span id="section-cb60-2"><a href="#section-cb60-2" tabindex="-1"></a></span>
<span id="section-cb60-3"><a href="#section-cb60-3" tabindex="-1"></a>tree_growth <span class="ot">&lt;-</span> <span class="fu">mutate</span>(trees, <span class="at">growth =</span> DBH_3 <span class="sc">-</span> DBH_2)</span>
<span id="section-cb60-4"><a href="#section-cb60-4" tabindex="-1"></a></span>
<span id="section-cb60-5"><a href="#section-cb60-5" tabindex="-1"></a><span class="co"># 2 Group by tree species and province (since this is the level at which we want the information)</span></span>
<span id="section-cb60-6"><a href="#section-cb60-6" tabindex="-1"></a></span>
<span id="section-cb60-7"><a href="#section-cb60-7" tabindex="-1"></a>by_sps_prov <span class="ot">&lt;-</span> <span class="fu">group_by</span>(tree_growth, Species, Province)</span>
<span id="section-cb60-8"><a href="#section-cb60-8" tabindex="-1"></a></span>
<span id="section-cb60-9"><a href="#section-cb60-9" tabindex="-1"></a><span class="co"># 3. Calculate the mean growth per species and province</span></span>
<span id="section-cb60-10"><a href="#section-cb60-10" tabindex="-1"></a></span>
<span id="section-cb60-11"><a href="#section-cb60-11" tabindex="-1"></a>mean_growth_data <span class="ot">&lt;-</span> <span class="fu">summarise</span>(by_sps_prov, <span class="at">mean_growth =</span> <span class="fu">mean</span>(growth))</span>
<span id="section-cb60-12"><a href="#section-cb60-12" tabindex="-1"></a></span>
<span id="section-cb60-13"><a href="#section-cb60-13" tabindex="-1"></a><span class="co"># 4. Filter for the province of Lleida</span></span>
<span id="section-cb60-14"><a href="#section-cb60-14" tabindex="-1"></a></span>
<span id="section-cb60-15"><a href="#section-cb60-15" tabindex="-1"></a>lleida_growth <span class="ot">&lt;-</span> <span class="fu">filter</span>(mean_growth_data, Province <span class="sc">==</span> <span class="st">&quot;25&quot;</span>)</span>
<span id="section-cb60-16"><a href="#section-cb60-16" tabindex="-1"></a></span>
<span id="section-cb60-17"><a href="#section-cb60-17" tabindex="-1"></a><span class="co"># 5. Sort the values from greatest to smallest growth</span></span>
<span id="section-cb60-18"><a href="#section-cb60-18" tabindex="-1"></a></span>
<span id="section-cb60-19"><a href="#section-cb60-19" tabindex="-1"></a><span class="fu">arrange</span>(lleida_growth, <span class="fu">desc</span>(mean_growth))</span></code></pre></div>
<pre><code>## # A tibble: 18 × 3
## # Groups:   Species [18]
##    Species Province mean_growth
##    &lt;fct&gt;   &lt;fct&gt;          &lt;dbl&gt;
##  1 050     25              4.53
##  2 031     25              4.04
##  3 070     25              3.13
##  4 021     25              3.09
##  5 024     25              2.99
##  6 025     25              2.93
##  7 019     25              2.88
##  8 071     25              2.84
##  9 255     25              2.64
## 10 022     25              2.44
## 11 042     25              2.39
## 12 976     25              2.30
## 13 044     25              2.24
## 14 243     25              2.13
## 15 078     25              1.83
## 16 073     25              1.75
## 17 045     25              1.46
## 18 090     25              1.25</code></pre>
<p>Remember that, unless we assign the <code>dplyr</code> operations to
an object, R will print the result of the operation, but will not save
it. You may have noticed that, in this case, I assigned each operation
to an object, so that it got stored in R memory, and I could use it
later to continue my analysis. However, this is not the ideal work flow,
since it forces us to create lots of intermediate objects that we are
not really interested in. In the next session we will see how to combine
<code>dplyr</code> verbs in a more efficient and elegant way, using the
“pipe” operator (<code>%&gt;%</code>). 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>


<script type="application/shiny-prerendered" data-context="server">
learnr:::prepare_tutorial_state(session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::i18n_observe_tutorial_language(input, session)
</script>


<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::event_trigger(session, "session_stop")
      })
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ex1-2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ex1-2-code-editor`)), session)
output$`tutorial-exercise-ex1-2-output` <- renderUI({
  `tutorial-exercise-ex1-2-result`()
})
</script>


<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "ex1-2", global_setup = NULL, setup = NULL, 
    chunks = list(list(label = "ex1-2", code = "", opts = list(
        label = "\"ex1-2\"", exercise = "TRUE"), engine = "r")), 
    code_check = NULL, error_check = NULL, check = NULL, solution = structure("filter(plot,Province %in% c(\"08\", \"17\"))", chunk_opts = list(
        label = "ex1-2-solution")), tests = NULL, options = list(
        eval = FALSE, echo = TRUE, results = "markup", tidy = FALSE, 
        tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = NA, 
        highlight = FALSE, size = "normalsize", background = "#F7F7F7", 
        strip.white = TRUE, cache = 0, cache.path = "U2L1_data_transformation_I_learnr_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "U2L1_data_transformation_I_learnr_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 8, fig.height = 5, fig.env = "figure", fig.cap = NULL, 
        fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 768, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = TRUE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        label = "ex1-2", exercise = TRUE, code = "", out.width.px = 768, 
        out.height.px = 480, params.src = "ex1-2, exercise = TRUE", 
        fig.num = 0L, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.28"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.28"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.28"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["templates/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmdformats"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.0.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.7"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["templates/bootstrap-3.3.7"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmdformats"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.0.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["readthedown"]},{"type":"character","attributes":{},"value":["0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["templates/readthedown"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["readthedown.js"]},{"type":"character","attributes":{},"value":["readthedown.css","readthedown_fonts_embed.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmdformats"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.0.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.28"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["6.4.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.min.css","css/v4-shims.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fontawesome"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["5.5.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.11.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69]}},"value":[{"type":"character","attributes":{},"value":["base","bookdown","bslib","cachem","cli","colorspace","compiler","datasets","digest","dplyr","evaluate","fansi","fastmap","fontawesome","forcats","generics","ggplot2","glue","graphics","grDevices","grid","gtable","hms","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","knitr","later","learnr","lifecycle","lubridate","magrittr","methods","mime","munsell","pillar","pkgconfig","promises","purrr","R6","Rcpp","readr","rlang","rmarkdown","rmdformats","rprojroot","rstudioapi","sass","scales","shiny","stats","stringi","stringr","tibble","tidyr","tidyselect","tidyverse","timechange","tools","tzdb","utf8","utils","vctrs","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["4.4.1","0.40","0.8.0","1.1.0","3.6.3","2.1-1","4.4.1","4.4.1","0.6.37","1.1.4","1.0.0","1.0.6","1.2.0","0.5.2","1.0.0","0.1.3","3.5.1","1.8.0","4.4.1","4.4.1","4.4.1","0.3.5","1.1.3","0.5.8.1","1.6.4","1.6.15","0.1.4","1.8.9","1.48","1.3.2","0.11.5","1.0.4","1.9.3","2.0.3","4.4.1","0.12","0.5.1","1.9.0","2.0.3","1.3.0","1.0.2","2.5.1","1.0.13","2.1.5","1.1.4","2.28","1.0.4","2.0.4","0.16.0","0.4.9","1.3.0","1.9.1","4.4.1","1.8.4","1.5.1","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","4.4.1","0.4.0","1.2.4","4.4.1","0.6.5","3.0.1","0.48","1.8-4","2.3.10"]}]}]}
</script>
<!--/html_preserve-->
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
